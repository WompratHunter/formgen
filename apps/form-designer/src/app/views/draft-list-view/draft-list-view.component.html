<div class="list-container">
  <div class="list-header">
    <h2>My Drafts</h2>
    <a mat-raised-button color="primary" routerLink="/prompt">+ New Form</a>
  </div>

  @if (loading()) {
    <div class="list-loading"><mat-spinner diameter="40" /></div>
  } @else if (!drafts().length) {
    <p class="empty-msg">No drafts yet. <a routerLink="/prompt">Generate your first form.</a></p>
  } @else {
    <div class="draft-list">
      @for (draft of drafts(); track draft.id) {
        <mat-card class="draft-card">
          <mat-card-header>
            <mat-card-title>{{ draft.name }}</mat-card-title>
            <mat-card-subtitle>
              {{ formatDate(draft.updated_at) }} Â· v{{ draft.version }}
            </mat-card-subtitle>
          </mat-card-header>

          @if (draft.description) {
            <mat-card-content>
              <p class="draft-description">{{ draft.description }}</p>
            </mat-card-content>
          }

          <mat-card-actions>
            <mat-chip [highlighted]="draft.status === 'saved'">{{ draft.status }}</mat-chip>
            <span class="actions-spacer"></span>
            <a mat-button color="primary" [routerLink]="['/drafts', draft.id]">Edit</a>
            <button
              mat-button
              color="warn"
              [disabled]="deletingId() === draft.id"
              (click)="delete(draft.id)"
            >
              @if (deletingId() === draft.id) {
                <mat-spinner diameter="16" />
              } @else {
                Delete
              }
            </button>
          </mat-card-actions>
        </mat-card>
      }
    </div>
  }
</div>
